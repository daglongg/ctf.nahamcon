# Brain Melt 2

Bài này tác giả có đề cập tới `Pyinstxtractor`. Tôi nghi khả năng cao là đây là file python và đúng thế thật. Tôi cần xác định đây là phiên bản của nó. và hình như nó là python 3.9. Đay là 1 phiên bản khá cao và không được uncompyler6 được. Vậy nên tôi sẽ dùng pycdc. 

![image](https://github.com/daglongg/ctf.nahamcon/assets/138242812/6274db9d-2a8a-46ea-9296-2892984174b7)

Đoạn này tôi thấy nó đang `decrypt` và công chúng vào với nhau. Fix code

```
import base64
from Crypto.Cipher import Salsa20

def decrypt1(encoded_str):
    decoded_str = ''
    for i in range(0, len(encoded_str), 2):
        segment = encoded_str[i:i+2] + '=='
        decoded_str += base64.b64decode(segment).decode('ascii')
    return decoded_str

def decrypt2(a1, a2):
    result = ''
    for character in a1:
        temp_value = (ord(character) - ord('a') + a2) % 26 + ord('a')
        result += chr(temp_value)
    return result

def decrypt3(s1, key):
    msg_nonce = s1[:8]
    ciphertext = s1[8:]
    cipher = Salsa20.new(key=key.encode('utf-8'), nonce=msg_nonce)
    return cipher.decrypt(ciphertext).decode('utf-8')

def deobfuscate():
    part1 = decrypt1('ZgbAYQZwewMAOAZQOQYwYwNQYgMA')
    part2 = decrypt2('fwvcttjsfvrshwsg', 17)
    part3 = decrypt3(b'\x97p#2\x1abw\x0f\x9a\xd1Z\x04b\x93\xa1h8]\xab\xa3\x9e7\xc9\xe8\x9b', '25dbd4f362f7d0e64b24ab231728a1fc')
    key = part1 + part2 + part3
    print(key)

deobfuscate()
```

và tôi có flag là : `flag{08e9cc5b0wnmtkkajwmijynjx3a415bd9a8024930}`
